=== デプロイファイル一覧（2025年9月19日 最終版） ===

【修正ファイル（全4ファイル）】

1. metaApi.js
2. dynamicAlertGenerator.js  
3. views/alerts.ejs
4. utils/multiUserChatworkSender.js

===========================================
【修正内容の詳細】
===========================================

【1. metaApi.js】
- 新規追加: fetchMetaDataWithStoredConfig関数（576-614行目）
  ユーザー設定からMeta APIデータを取得
- 修正: fetchMetaAdDailyStats関数（395-404行目）
  app_idパラメータをオプショナルに変更
- module.exportsにfetchMetaDataWithStoredConfigを追加

【2. dynamicAlertGenerator.js】
- 修正: formatValue関数（42-66行目）
  * CTR、CVR: 小数点第1位まで（0.899888 → 0.9%）
  * 予算消化率: 整数表示（62.178 → 62%）
  * CPA、CPM、CPC: 整数でカンマ区切り（1926.884 → 1,927円）
- 修正: generateDynamicAlerts関数（202-219行目）  
  保存値を元の値のまま保持（表示時のみフォーマット）
- 新規追加: saveAlertsToHistory関数（403-447行目）
  アラート履歴の自動保存

【3. views/alerts.ejs】
- 修正: formatMetricValue関数（533-555行目）
  * CTR、CVR: 小数点第1位まで表示
  * 予算消化率: 整数表示
  * CPA、CPM、CPC: 整数でカンマ区切り

【4. utils/multiUserChatworkSender.js】
- 修正: formatValue関数（156-178行目）
  チャットワーク送信時の数値フォーマット
  * 予算消化率を整数表示に修正
- 修正: 日次レポートメッセージ生成（66-78行目）
  予算消化率を整数表示（小数点なし）

===========================================
【実装結果】
===========================================

✅ Meta APIから実際のデータ取得
✅ 数値の適切な表示：
  - CTR: 0.990099 → 1.0%（保存値は元のまま）
  - CPM: 1943.894389 → 1,944円（保存値は元のまま）  
  - 予算消化率: 63.10714285714286 → 63%（保存値は元のまま）
✅ チャットワーク通知も同じフォーマット
✅ マルチユーザー対応（userIdで分離）

===========================================
【デプロイ時の注意事項】
===========================================

1. 4つのファイル全てをアップロード
2. サーバー再起動が必要
3. alert_history.jsonの書き込み権限を確認
4. ユーザー設定ファイルは既存のものを使用

===========================================
【動作確認済み環境】
===========================================

- ローカル: http://localhost:3000
- ユーザー: komiya11122@gmail.com
- アカウント: act_1165556408678089
- 生成アラート: CTR、CPM、CV、予算消化率